<!DOCTYPE html>

<head>
    <meta charset="utf-8">
    <title>Knockoff Demo</title>
</head>

<body>
    <h1>Knockoff Demo</h1>

    <h2>Character Sheet for <span data-mapping="name"></span></h2>
    <p>
        <label>Name: <input data-mapping="name" type="text"></label>
    </p>
    <p>
        <label>Level: <input data-mapping="level" type="text"></label>
    </p>
    <p>
        <label>
            Race:
            <select data-mapping="race">
                <option value="">Select one...</option>
                <option value="Human">Human</option>
                <option value="Klingon">Klingon</option>
                <option value="Vulcan">Vulcan</option>
            </select>
        </label>
    </p>
    <p>
        <label>Strength: <input data-mapping="strength" type="text"></label>
    </p>
    <p>
        <label><input data-mapping="undead" type="checkbox" value="true"> Undead</label>
    </p>

    <h2>Wisdom</h2>
    <p>
        <label>Score: <input data-mapping="wisdom.score" type="text"></label>
    </p>
    <p>
        <label>Modifier: <input data-mapping="wisdom.modifier" type="text"></label>
    </p>

    <h2>Skills</h2>
    <h3>Programming</h3>
    <p>
        <label>Day: <input data-mapping="skills.programming.day" type="text"><label>
    </p>
    <p>
        <label>Night: <input data-mapping="skills.programming.night" type="text"><label>
    </p>
</body>

<script src="js/KO-1.0.27.js"></script>
<script>
    // ECMAScript 5 strict mode
    'use strict';

    function Person(params) {
        params = params || {};

        this.name = params.name;
        this.level = params.level;
        this.race = params.race;
        this.strength = params.strength;
        this.undead = params.undead;
        this.wisdom = params.wisdom;
        this.skills = params.skills;
    }

    var person = new Person({
        name: 'Dave',
        level: 10,
        race: 'Human',
        strength: 4,
        undead: true,
        wisdom: {
            score: 5,
            modifier: -2
        },
        skills: {
            programming: {
                day: 10,
                night: 100
            }
        }
    });

    KO.bind(person);

    KO.listen(['level', 'undead'], function () {
        person.strength = person.level / 2;

        if (person.undead) {
            person.strength--;
        }
    });

    KO.validate('level', function (value) {
        return value !== '' && !isNaN(value);
    });

    KO.validate(['skills.programming.day', 'skills.programming.night'], function (value) {
        return value >= 0 && value <= 100;
    });
</script>
